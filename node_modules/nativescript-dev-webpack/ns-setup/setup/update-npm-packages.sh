#!/bin/bash

npm cache clean
sudo rm -rf ~/.npm/tns-* && true

npm uninstall -g appium && true
npm install -g appium@1.6.5

npm uninstall -g gulp-cli && true
npm install --g gulp-cli

npm uninstall -g grunt-cli && true
npm install -g grunt-cli

if [[ "$OSTYPE" == "darwin"* ]]; then
    npm uninstall -g deviceconsole && true
    npm install -g deviceconsole
    if xcodebuild -version | grep -q 'Xcode 9.'; then
        echo "Xcode 9 detected!"
        echo "Please handle appium and ios-deploy installation manually!"
    else
        npm uninstall -g ios-deploy && true
        npm install -g ios-deploy
    fi
fi
